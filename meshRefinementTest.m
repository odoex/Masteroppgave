% Number of points in space and time
m = 3;
n = 10;

y_0 = 0;
y_m = 1;
x_0 = 0;
x_m = 1;
t_0 = 0;
t_n = 1;

% Space and time steps
h = (x_m-x_0)/(m-1);
k = (t_n-t_0)/(n-1);

% Grid creation (Ikke lagre i skriptet ovenfor)
% G = Node(0, [x_0,y_0], h, k, m, n);
% x = linspace(G.location(1),G.location(1) + (G.m-1)*G.h,G.m)';
% y = linspace(G.location(2),G.location(2) + (G.m-1)*G.h,G.m)';

x = linspace(x_0,x_m,m)';
y = linspace(y_0,y_m,m)';

[X,Y] = meshgrid(x,y);

a = 0.5;
b = 1;

% Initial and boundary conditions
F = sin(X) + sin(Y);

g_x = @(s,z) (sin(z-a*s) + sin(-b*s)); 
g_y = @(s,z) (sin(-a*s) + sin(z-b*s));

% Initializing the solution U (skal lagres i grid)
U = F;
U_n = F;

t = t_0;

f = @(x,y,s) sin(x - a*s) + sin(y - b*s);

G = Node(0,[0,0,1,1],1/(m-1), k, m, n);

G.u = createSolutionVector(G);

round = @(v,d) floor(v*10^d)/10^d;

%% Test 1: createSolutionVector
val=floor(norm(G.u - F)*1000)/1000;
assert(floor(norm(G.u - F)*1000)/1000 == 0);

%% Test 2: boundary
U = G.u;
[gx,gy] = boundary(G,f,k);
v = g_x(k,x);
assert(round(norm(g_x(k,x)-gx),3)==0)

%% Test 3: comparing numbers
x = linspace(0,1,4);
[X,Y]=meshgrid(x,x);
u = (sin(X-a*0) + sin(Y-b*0))';
gx=u(:,1);
gy=u(:,1);
h=1/3;
k=1/9;
h1=h/2;

%
n=50;
t_0=0;
fake_k = (1-t_0)/(n-1);
t_n=fake_k;
k = t_n;

%

x_c = linspace(h,2*h,3);
[Xc,Yc]=meshgrid(x_c,x_c);
u_c = (sin(Xc-a*0) + sin(Yc-b*0))';
gxc=u_c(:,1);
gyc=u_c(:,1);

u_nc=u_c;
k1c=u_c;
% k1
k1c(1,1)=-0.5*(u_c(2,1)-gyc(1))/h1-(u_c(1,2)-gxc(1))/h1;
k1c(1,2)=-0.5*(u_c(2,2)-gyc(2))/h1-(u_c(1,3)-u_c(1,1))/(2*h1);
k1c(1,3)=-0.5*(u_c(2,3)-gyc(3))/h1-(u_c(1,3)-u_c(1,2))/h1;

k1c(2,1)=-0.5*(u_c(3,1)-u_c(1,1))/(2*h1)-(u_c(2,2)-gxc(2))/h1;
k1c(2,2)=-0.5*(u_c(3,2)-u_c(1,2))/(2*h1)-(u_c(2,3)-u_c(2,1))/(2*h1);
k1c(2,3)=-0.5*(u_c(3,3)-u_c(1,3))/(2*h1)-(u_c(2,3)-u_c(2,2))/h1;

k1c(3,1)=-0.5*(u_c(3,1)-u_c(2,1))/h1-(u_c(3,2)-gxc(3))/h1;
k1c(3,2)=-0.5*(u_c(3,2)-u_c(2,2))/h1-(u_c(3,3)-u_c(3,1))/(2*h1);
k1c(3,3)=-0.5*(u_c(3,3)-u_c(2,3))/h1-(u_c(3,3)-u_c(3,2))/h1;

%k2c
k2c(1,1)=-0.5*(u_c(2,1)+(k/2)*k1c(2,1)-gyc(1))/h1-(u_c(1,2)+(k/2)*k1c(1,2)-gxc(1))/h1;
k2c(1,2)=-0.5*(u_c(2,2)+(k/2)*k1c(2,2)-gyc(2))/h1-(u_c(1,3)+(k/2)*k1c(1,3)-u_c(1,1)-(k/2)*k1c(1,1))/(2*h1);
k2c(1,3)=-0.5*(u_c(2,3)+(k/2)*k1c(2,3)-gyc(3))/h1-(u_c(1,3)+(k/2)*k1c(1,3)-u_c(1,2)-(k/2)*k1c(1,2))/h1;

k2c(2,1)=-0.5*(u_c(3,1)+(k/2)*k1c(3,1)-u_c(1,1)-(k/2)*k1c(1,1))/(2*h1)-(u_c(2,2)+(k/2)*k1c(2,2)-gxc(2))/h1;
k2c(2,2)=-0.5*(u_c(3,2)+(k/2)*k1c(3,2)-u_c(1,2)-(k/2)*k1c(1,2))/(2*h1)-(u_c(2,3)+(k/2)*k1c(2,3)-u_c(2,1)-(k/2)*k1c(2,1))/(2*h1);
k2c(2,3)=-0.5*(u_c(3,3)+(k/2)*k1c(3,3)-u_c(1,3)-(k/2)*k1c(1,3))/(2*h1)-(u_c(2,3)+(k/2)*k1c(2,3)-u_c(2,2)-(k/2)*k1c(2,2))/h1;

k2c(3,1)=-0.5*(u_c(3,1)+(k/2)*k1c(3,1)-u_c(2,1)-(k/2)*k1c(2,1))/h1-(u_c(3,2)+(k/2)*k1c(3,2)-gxc(3))/h1;
k2c(3,2)=-0.5*(u_c(3,2)+(k/2)*k1c(3,2)-u_c(2,2)-(k/2)*k1c(2,2))/h1-(u_c(3,3)+(k/2)*k1c(3,3)-u_c(3,1)-(k/2)*k1c(3,1))/(2*h1);
k2c(3,3)=-0.5*(u_c(3,3)+(k/2)*k1c(3,3)-u_c(2,3)-(k/2)*k1c(2,3))/h1-(u_c(3,3)+(k/2)*k1c(3,3)-u_c(3,2)-(k/2)*k1c(3,2))/h1;

%k3c
k3c(1,1)=-0.5*(u_c(2,1)+(k/2)*k2c(2,1)-gyc(1))/h1-(u_c(1,2)+(k/2)*k2c(1,2)-gxc(1))/h1;
k3c(1,2)=-0.5*(u_c(2,2)+(k/2)*k2c(2,2)-gyc(2))/h1-(u_c(1,3)+(k/2)*k2c(1,3)-u_c(1,1)-(k/2)*k2c(1,1))/(2*h1);
k3c(1,3)=-0.5*(u_c(2,3)+(k/2)*k2c(2,3)-gyc(3))/h1-(u_c(1,3)+(k/2)*k2c(1,3)-u_c(1,2)-(k/2)*k2c(1,2))/h1;

k3c(2,1)=-0.5*(u_c(3,1)+(k/2)*k2c(3,1)-u_c(1,1)-(k/2)*k2c(1,1))/(2*h1)-(u_c(2,2)+(k/2)*k2c(2,2)-gxc(2))/h1;
k3c(2,2)=-0.5*(u_c(3,2)+(k/2)*k2c(3,2)-u_c(1,2)-(k/2)*k2c(1,2))/(2*h1)-(u_c(2,3)+(k/2)*k2c(2,3)-u_c(2,1)-(k/2)*k2c(2,1))/(2*h1);
k3c(2,3)=-0.5*(u_c(3,3)+(k/2)*k2c(3,3)-u_c(1,3)-(k/2)*k2c(1,3))/(2*h1)-(u_c(2,3)+(k/2)*k2c(2,3)-u_c(2,2)-(k/2)*k2c(2,2))/h1;

k3c(3,1)=-0.5*(u_c(3,1)+(k/2)*k2c(3,1)-u_c(2,1)-(k/2)*k2c(2,1))/h1-(u_c(3,2)+(k/2)*k2c(3,2)-gxc(3))/h1;
k3c(3,2)=-0.5*(u_c(3,2)+(k/2)*k2c(3,2)-u_c(2,2)-(k/2)*k2c(2,2))/h1-(u_c(3,3)+(k/2)*k2c(3,3)-u_c(3,1)-(k/2)*k2c(3,1))/(2*h1);
k3c(3,3)=-0.5*(u_c(3,3)+(k/2)*k2c(3,3)-u_c(2,3)-(k/2)*k2c(2,3))/h1-(u_c(3,3)+(k/2)*k2c(3,3)-u_c(3,2)-(k/2)*k2c(3,2))/h1;

%k4c
k4c(1,1)=-0.5*(u_c(2,1)+(k)*k3c(2,1)-gyc(1))/h1-(u_c(1,2)+(k)*k3c(1,2)-gxc(1))/h1;
k4c(1,2)=-0.5*(u_c(2,2)+(k)*k3c(2,2)-gyc(2))/h1-(u_c(1,3)+(k)*k3c(1,3)-u_c(1,1)-(k)*k3c(1,1))/(2*h1);
k4c(1,3)=-0.5*(u_c(2,3)+(k)*k3c(2,3)-gyc(3))/h1-(u_c(1,3)+(k)*k3c(1,3)-u_c(1,2)-(k)*k3c(1,2))/h1;

k4c(2,1)=-0.5*(u_c(3,1)+(k)*k3c(3,1)-u_c(1,1)-(k)*k3c(1,1))/(2*h1)-(u_c(2,2)+(k)*k3c(2,2)-gxc(2))/h1;
k4c(2,2)=-0.5*(u_c(3,2)+(k)*k3c(3,2)-u_c(1,2)-(k)*k3c(1,2))/(2*h1)-(u_c(2,3)+(k)*k3c(2,3)-u_c(2,1)-(k)*k3c(2,1))/(2*h1);
k4c(2,3)=-0.5*(u_c(3,3)+(k)*k3c(3,3)-u_c(1,3)-(k)*k3c(1,3))/(2*h1)-(u_c(2,3)+(k)*k3c(2,3)-u_c(2,2)-(k)*k3c(2,2))/h1;

k4c(3,1)=-0.5*(u_c(3,1)+(k)*k3c(3,1)-u_c(2,1)-(k)*k3c(2,1))/h1-(u_c(3,2)+(k)*k3c(3,2)-gxc(3))/h1;
k4c(3,2)=-0.5*(u_c(3,2)+(k)*k3c(3,2)-u_c(2,2)-(k)*k3c(2,2))/h1-(u_c(3,3)+(k)*k3c(3,3)-u_c(3,1)-(k)*k3c(3,1))/(2*h1);
k4c(3,3)=-0.5*(u_c(3,3)+(k)*k3c(3,3)-u_c(2,3)-(k)*k3c(2,3))/h1-(u_c(3,3)+(k)*k3c(3,3)-u_c(3,2)-(k)*k3c(3,2))/h1;

u_nc = u_c + (k/6)*(k1c + 2*k2c + 2*k3c + k4c);

u_c = u_nc;



%k1
k1(1,1)=-0.5*(u(2,1)-gy(1))/h-(u(1,2)-gx(1))/h;
k1(1,2)=-0.5*(u(2,2)-gy(2))/h-(u(1,3)-u(1,1))/(2*h);
k1(1,3)=-0.5*(u(2,3)-gy(3))/h-(u(1,4)-u(1,2))/(2*h);
k1(1,4)=-0.5*(u(2,4)-gy(4))/h-(u(1,4)-u(1,3))/h;

k1(2,1)=-0.5*(u(3,1)-u(1,1))/(2*h)-(u(2,2)-gx(2))/h;
k1(2,2)=-0.5*(u(3,2)-u(1,2))/(2*h)-(u(2,3)-u(2,1))/(2*h);
k1(2,3)=-0.5*(u(3,3)-u(1,3))/(2*h)-(u(2,4)-u(2,2))/(2*h);
k1(2,4)=-0.5*(u(3,4)-u(1,4))/(2*h)-(u(2,4)-u(2,3))/h;

k1(3,1)=-0.5*(u(4,1)-u(2,1))/(2*h)-(u(3,2)-gx(3))/h;
k1(3,2)=-0.5*(u(4,2)-u(2,2))/(2*h)-(u(3,3)-u(3,1))/(2*h);
k1(3,3)=-0.5*(u(4,3)-u(2,3))/(2*h)-(u(3,4)-u(3,2))/(2*h);
k1(3,4)=-0.5*(u(4,4)-u(2,4))/(2*h)-(u(3,4)-u(3,3))/h;

k1(4,1)=-0.5*(u(4,1)-u(3,1))/h-(u(4,2)-gx(4))/h;
k1(4,2)=-0.5*(u(4,2)-u(3,2))/h-(u(4,3)-u(4,1))/(2*h);
k1(4,3)=-0.5*(u(4,3)-u(3,3))/h-(u(4,4)-u(4,2))/(2*h);
k1(4,4)=-0.5*(u(4,4)-u(3,4))/h-(u(4,4)-u(4,3))/h;

% - a*(U(i+1,j) - g_y(j))/h;
%- b*(U(i,j+1) - g_x(i))/h;

%k2
U1 = u(2,1)+(k/2)*k1(2,1);
U2 = u(1,2)+(k/2)*k1(1,2);
k2(1,1)=-0.5*(u(2,1)+(k/2)*k1(2,1)-gy(1))/h-(u(1,2)+(k/2)*k1(1,2)-gx(1))/h;
k2(1,2)=-0.5*(u(2,2)+(k/2)*k1(2,2)-gy(2))/h-(u(1,3)+(k/2)*k1(1,3)-u(1,1)-(k/2)*k1(1,1))/(2*h);
k2(1,3)=-0.5*(u(2,3)+(k/2)*k1(2,3)-gy(3))/h-(u(1,4)+(k/2)*k1(1,4)-u(1,2)-(k/2)*k1(1,2))/(2*h);
k2(1,4)=-0.5*(u(2,4)+(k/2)*k1(2,4)-gy(4))/h-(u(1,4)+(k/2)*k1(1,4)-u(1,3)-(k/2)*k1(1,3))/h;

k2(2,1)=-0.5*(u(3,1)+(k/2)*k1(3,1)-u(1,1)-(k/2)*k1(1,1))/(2*h)-(u(2,2)+(k/2)*k1(2,2)-gx(2))/h;
k2(2,2)=-0.5*(u(3,2)+(k/2)*k1(3,2)-u(1,2)-(k/2)*k1(1,2))/(2*h)-(u(2,3)+(k/2)*k1(2,3)-u(2,1)-(k/2)*k1(2,1))/(2*h);
k2(2,3)=-0.5*(u(3,3)+(k/2)*k1(3,3)-u(1,3)-(k/2)*k1(1,3))/(2*h)-(u(2,4)+(k/2)*k1(2,4)-u(2,2)-(k/2)*k1(2,2))/(2*h);
k2(2,4)=-0.5*(u(3,4)+(k/2)*k1(3,4)-u(1,4)-(k/2)*k1(1,4))/(2*h)-(u(2,4)+(k/2)*k1(2,4)-u(2,3)-(k/2)*k1(2,3))/h;

k2(3,1)=-0.5*(u(4,1)+(k/2)*k1(4,1)-u(2,1)-(k/2)*k1(2,1))/(2*h)-(u(3,2)+(k/2)*k1(3,2)-gx(3))/h;
k2(3,2)=-0.5*(u(4,2)+(k/2)*k1(4,2)-u(2,2)-(k/2)*k1(2,2))/(2*h)-(u(3,3)+(k/2)*k1(3,3)-u(3,1)-(k/2)*k1(3,1))/(2*h);
k2(3,3)=-0.5*(u(4,3)+(k/2)*k1(4,3)-u(2,3)-(k/2)*k1(2,3))/(2*h)-(u(3,4)+(k/2)*k1(3,4)-u(3,2)-(k/2)*k1(3,2))/(2*h);
k2(3,4)=-0.5*(u(4,4)+(k/2)*k1(4,4)-u(2,4)-(k/2)*k1(2,4))/(2*h)-(u(3,4)+(k/2)*k1(3,4)-u(3,3)-(k/2)*k1(3,3))/h;

k2(4,1)=-0.5*(u(4,1)+(k/2)*k1(4,1)-u(3,1)-(k/2)*k1(3,1))/h-(u(4,2)+(k/2)*k1(4,2)-gx(4))/h;
k2(4,2)=-0.5*(u(4,2)+(k/2)*k1(4,2)-u(3,2)-(k/2)*k1(3,2))/h-(u(4,3)+(k/2)*k1(4,3)-u(4,1)-(k/2)*k1(4,1))/(2*h);
k2(4,3)=-0.5*(u(4,3)+(k/2)*k1(4,3)-u(3,3)-(k/2)*k1(3,3))/h-(u(4,4)+(k/2)*k1(4,4)-u(4,2)-(k/2)*k1(4,2))/(2*h);
k2(4,4)=-0.5*(u(4,4)+(k/2)*k1(4,4)-u(3,4)-(k/2)*k1(3,4))/h-(u(4,4)+(k/2)*k1(4,4)-u(4,3)-(k/2)*k1(4,3))/h;

%k3
k3(1,1)=-0.5*(u(2,1)+(k/2)*k2(2,1)-gy(1))/h-(u(1,2)+(k/2)*k2(1,2)-gx(1))/h;
k3(1,2)=-0.5*(u(2,2)+(k/2)*k2(2,2)-gy(2))/h-(u(1,3)+(k/2)*k2(1,3)-u(1,1)-(k/2)*k2(1,1))/(2*h);
k3(1,3)=-0.5*(u(2,3)+(k/2)*k2(2,3)-gy(3))/h-(u(1,4)+(k/2)*k2(1,4)-u(1,2)-(k/2)*k2(1,2))/(2*h);
k3(1,4)=-0.5*(u(2,4)+(k/2)*k2(2,4)-gy(4))/h-(u(1,4)+(k/2)*k2(1,4)-u(1,3)-(k/2)*k2(1,3))/h;

k3(2,1)=-0.5*(u(3,1)+(k/2)*k2(3,1)-u(1,1)-(k/2)*k2(1,1))/(2*h)-(u(2,2)+(k/2)*k2(2,2)-gx(2))/h;
k3(2,2)=-0.5*(u(3,2)+(k/2)*k2(3,2)-u(1,2)-(k/2)*k2(1,2))/(2*h)-(u(2,3)+(k/2)*k2(2,3)-u(2,1)-(k/2)*k2(2,1))/(2*h);
k3(2,3)=-0.5*(u(3,3)+(k/2)*k2(3,3)-u(1,3)-(k/2)*k2(1,3))/(2*h)-(u(2,4)+(k/2)*k2(2,4)-u(2,2)-(k/2)*k2(2,2))/(2*h);
k3(2,4)=-0.5*(u(3,4)+(k/2)*k2(3,4)-u(1,4)-(k/2)*k2(1,4))/(2*h)-(u(2,4)+(k/2)*k2(2,4)-u(2,3)-(k/2)*k2(2,3))/h;

k3(3,1)=-0.5*(u(4,1)+(k/2)*k2(4,1)-u(2,1)-(k/2)*k2(2,1))/(2*h)-(u(3,2)+(k/2)*k2(3,2)-gx(3))/h;
k3(3,2)=-0.5*(u(4,2)+(k/2)*k2(4,2)-u(2,2)-(k/2)*k2(2,2))/(2*h)-(u(3,3)+(k/2)*k2(3,3)-u(3,1)-(k/2)*k2(3,1))/(2*h);
k3(3,3)=-0.5*(u(4,3)+(k/2)*k2(4,3)-u(2,3)-(k/2)*k2(2,3))/(2*h)-(u(3,4)+(k/2)*k2(3,4)-u(3,2)-(k/2)*k2(3,2))/(2*h);
k3(3,4)=-0.5*(u(4,4)+(k/2)*k2(4,4)-u(2,4)-(k/2)*k2(2,4))/(2*h)-(u(3,4)+(k/2)*k2(3,4)-u(3,3)-(k/2)*k2(3,3))/h;

k3(4,1)=-0.5*(u(4,1)+(k/2)*k2(4,1)-u(3,1)-(k/2)*k2(3,1))/h-(u(4,2)+(k/2)*k2(4,2)-gx(4))/h;
k3(4,2)=-0.5*(u(4,2)+(k/2)*k2(4,2)-u(3,2)-(k/2)*k2(3,2))/h-(u(4,3)+(k/2)*k2(4,3)-u(4,1)-(k/2)*k2(4,1))/(2*h);
k3(4,3)=-0.5*(u(4,3)+(k/2)*k2(4,3)-u(3,3)-(k/2)*k2(3,3))/h-(u(4,4)+(k/2)*k2(4,4)-u(4,2)-(k/2)*k2(4,2))/(2*h);
k3(4,4)=-0.5*(u(4,4)+(k/2)*k2(4,4)-u(3,4)-(k/2)*k2(3,4))/h-(u(4,4)+(k/2)*k2(4,4)-u(4,3)-(k/2)*k2(4,3))/h;

%k4
k4(1,1)=-0.5*(u(2,1)+(k)*k3(2,1)-gy(1))/h-(u(1,2)+(k)*k3(1,2)-gx(1))/h;
k4(1,2)=-0.5*(u(2,2)+(k)*k3(2,2)-gy(2))/h-(u(1,3)+(k)*k3(1,3)-u(1,1)-(k)*k3(1,1))/(2*h);
k4(1,3)=-0.5*(u(2,3)+(k)*k3(2,3)-gy(3))/h-(u(1,4)+(k)*k3(1,4)-u(1,2)-(k)*k3(1,2))/(2*h);
k4(1,4)=-0.5*(u(2,4)+(k)*k3(2,4)-gy(4))/h-(u(1,4)+(k)*k3(1,4)-u(1,3)-(k)*k3(1,3))/h;

k4(2,1)=-0.5*(u(3,1)+(k)*k3(3,1)-u(1,1)-(k)*k3(1,1))/(2*h)-(u(2,2)+(k)*k3(2,2)-gx(2))/h;
k4(2,2)=-0.5*(u(3,2)+(k)*k3(3,2)-u(1,2)-(k)*k3(1,2))/(2*h)-(u(2,3)+(k)*k3(2,3)-u(2,1)-(k)*k3(2,1))/(2*h);
k4(2,3)=-0.5*(u(3,3)+(k)*k3(3,3)-u(1,3)-(k)*k3(1,3))/(2*h)-(u(2,4)+(k)*k3(2,4)-u(2,2)-(k)*k3(2,2))/(2*h);
k4(2,4)=-0.5*(u(3,4)+(k)*k3(3,4)-u(1,4)-(k)*k3(1,4))/(2*h)-(u(2,4)+(k)*k3(2,4)-u(2,3)-(k)*k3(2,3))/h;

k4(3,1)=-0.5*(u(4,1)+(k)*k3(4,1)-u(2,1)-(k)*k3(2,1))/(2*h)-(u(3,2)+(k)*k3(3,2)-gx(3))/h;
k4(3,2)=-0.5*(u(4,2)+(k)*k3(4,2)-u(2,2)-(k)*k3(2,2))/(2*h)-(u(3,3)+(k)*k3(3,3)-u(3,1)-(k)*k3(3,1))/(2*h);
k4(3,3)=-0.5*(u(4,3)+(k)*k3(4,3)-u(2,3)-(k)*k3(2,3))/(2*h)-(u(3,4)+(k)*k3(3,4)-u(3,2)-(k)*k3(3,2))/(2*h);
k4(3,4)=-0.5*(u(4,4)+(k)*k3(4,4)-u(2,4)-(k)*k3(2,4))/(2*h)-(u(3,4)+(k)*k3(3,4)-u(3,3)-(k)*k3(3,3))/h;

k4(4,1)=-0.5*(u(4,1)+(k)*k3(4,1)-u(3,1)-(k)*k3(3,1))/h-(u(4,2)+(k)*k3(4,2)-gx(4))/h;
k4(4,2)=-0.5*(u(4,2)+(k)*k3(4,2)-u(3,2)-(k)*k3(3,2))/h-(u(4,3)+(k)*k3(4,3)-u(4,1)-(k)*k3(4,1))/(2*h);
k4(4,3)=-0.5*(u(4,3)+(k)*k3(4,3)-u(3,3)-(k)*k3(3,3))/h-(u(4,4)+(k)*k3(4,4)-u(4,2)-(k)*k3(4,2))/(2*h);
k4(4,4)=-0.5*(u(4,4)+(k)*k3(4,4)-u(3,4)-(k)*k3(3,4))/h-(u(4,4)+(k)*k3(4,4)-u(4,3)-(k)*k3(4,3))/h;

u_n = u + (k/6)*(k1 + 2*k2 + 2*k3 + k4);

u=u_n;

u(2,2)=u_c(1,1);
u(2,3)=u_c(1,3);
u(3,2)=u_c(3,1);
u(3,3)=u_c(3,3);

n=50;
t_0=0;
fake_k = (1-t_0)/(n-1);
t_n=fake_k;
k = t_n;

G = Node(0,[0,0,1,1],h,k,4,1);
G.t=0;
G_0=Node(0,[h,h,2,2],h1,k,3,1);
G_0.parent=G;
G.child = G_0;
G.child.t=0;

G.u = createSolutionVector(G);
G.child.u = createSolutionVector(G.child);
t = 0;


G_test = finiteVolume(G,a,b,t_0,t_n,f);

u_test=G_test.u;

error = round(norm(abs(u_test-u)),3);

assert(error == 0)
